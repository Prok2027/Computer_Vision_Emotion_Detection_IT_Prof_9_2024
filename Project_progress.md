# Emotion Detection 
Проект по профильный информатике, 9 класс, 2024.
Проект решает задачу определения лица человека в кадре и классификации его эмоции в режим реального времени.

Для реализации проекта, он был разбит на следующие этапы:
  1. *Сбор данных для обучения модели*
  2. *Обработка и аугментация данных*
  3. *Создание и обучение сверточной нейронной сети по определению эмоции на картинке (статичной)*
  4. *Реализация работы модели из п.3 в режиме реального времени*

## Шаг 1: Сбор данных
Сначала надо найти достаточно много данных, чтобы обучить модель хорошо искать закономерности. Так как временные ресурсы не позволяли мне собирать свой датасет или размечать его в вручную, то я решил попробовать найти уже готовые датасеты в интернете.
Большинство из них были, к сожалению, приватные, такие как датасеты (на 400 тыс. изображений) СПбГУ, поэтому я решил искать их на [kaggle](https://www.kaggle.com/). Я нашел два размеченных датасета с достаточно хорошими картинками:
  1. https://www.kaggle.com/datasets/sujaykapadnis/emotion-recognition-dataset (>15k файлов, список эмоций - Ahegao, Angry, Happy, Sad, Neutral, Surprise)
  2. https://www.kaggle.com/datasets/tapakah68/facial-emotion-recognition (152 изображения, список эмоций - Angry, Contempt, Disgust, Fear, Happy, Neutral, Sad, Surprised)

Замечание 1: Из датасета 1, удалим эмоцию Ahegao, как минимум в силу школьной политики.

Замечание 2: Эмоции Contempt, Disgust имеет очень маленькую выборку изображений. Стоит подумать, стоит ли вообще их оставлять, если да, то нужно сделать хорошую аугментацию.
*Необходимо скачать датасеты по ссылкам выше, и разахивировать архивы. Если вы работаете не локально, то сделать возможность доступа из среды программирования, в которой вы работаете (я буду это делать с помощью GoogleColab)*

## Шаг 2: Обработка и аугментация данных
Нейронную сеть я буду писать с помощью библиотеки PyTorch, поэтому все изображение в итоге надо будет привести к tensor формату. Также, надо заметить, что данных не очень много, особенно по эмоциям Contempt, Disgust, поэтому необходимо будет провести аугментацию данных. Также необходимо будет достать все изображение из папки, доступной в среде, и конвертировать их в соотвествующий формат. Также потребуется создавать DataFrame для того чтобы не потерять верную классификацию картинки. Для всего этого шага нам потребуются следующие библиотеки (если их нет, то нужно их скачать):
  - [PyTorch](https://pytorch.org/)
  - [Pandas](https://pandas.pydata.org/)
  - [PIL](https://python-pillow.org/)
  - [torchvision](https://pytorch.org/vision/stable/index.html)
  - [OS](https://docs.python.org/3/library/os.html)

Начнем с того, что картинки надо достать из папки, совместить их с верной классификацией и сложить в один датафрейм, чтобы не потерять. 
Будем использовать наивнейший алгоритм, то есть просто пройдемся циклом по папке, помещая в колонку DataFrame "file_path" путь до данной картинки, а в колонку "emotion" название правильной эмоции данной картинки. После этого пройдемся по колонке "emotion" получившегося датафрейма, и будем менять эмоцию на цифру, соотвествующею её классу, по следующей схеме: 
{'Anger.jpg': 0, 'Contempt.jpg': 1, 'Disgust.jpg': 2, 'Fear.jpg': 3, 'Happy.jpg': 4, 'Neutral.jpg': 5, 'Sad.jpg': 6, 'Surprised.jpg': 7}.

Приложенные картинки имеют достаточно хорошее качество, однако могут иметь различный размер.
